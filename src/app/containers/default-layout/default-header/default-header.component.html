<!--<c-header class="mb-4 d-print-none" position="sticky">-->
<ng-container>
  <c-container [fluid]="true">
    <button toggle="visible" cHeaderToggler [cSidebarToggle]="sidebarId" class="ps-1">
      <svg cIcon name="cilMenu" size="lg"></svg>
    </button>
    <c-header-nav class="d-none d-lg-flex me-auto">
      <button (click)="navigateToHome()" class="ps-1" cButton color="ghost" cTooltip="Trang chủ" [cTooltipOptions]="{ placement: 'bottom' }">
        <svg cIcon name="cilHome" size="lg"></svg>
      </button>
    </c-header-nav>
    <c-header-nav class="d-none d-lg-flex notification-dropdown" *ngIf="isLoggedIn">
      <c-dropdown alignment="end" variant="nav-item">
        <button cButton color="" name="cilBell" [caret]="false" cDropdownToggle class="py-0 btn-avatar">
          <svg cIcon name="cilBell" size="lg"></svg>
          <span class="badge bg-danger">{{ notifications.length }}</span>
        </button>
        <ul cDropdownMenu class="dropdown-menu dropdown-menu-end">
          <li *ngFor="let notification of notifications">
            <div class="dropdown-item">
              <strong>{{ notification.message }}</strong><br>
              <small class="text-muted">{{ notification.time | date:'dd/MM/yyyy HH:mm' }}</small>

            </div>
          </li>
          <li *ngIf="notifications.length === 0">
            <div class="dropdown-item text-muted">
              Không có thông báo
            </div>
          </li>
        </ul>
      </c-dropdown>
    </c-header-nav>

    <!-- Nút giỏ hàng (hiển thị cho ROLE_USER) -->
    <c-header-nav class="d-none d-lg-flex ms-3">
      <c-dropdown alignment="end" variant="nav-item" *ngIf="isLoggedIn && isUserRole">
        <button cButton color="" name="cilCart" [caret]="false" cDropdownToggle class="py-0 btn-avatar">
          <svg cIcon name="cilCart" size="lg"></svg>
          <span class="badge bg-danger" *ngIf="cartItemCount > 0">
            {{ cartItemCount }}
          </span>
        </button>
        <ul cDropdownMenu class="dropdown-menu dropdown-menu-end">
          <li *ngFor="let item of cartItems">
            <div class="dropdown-item">
              <div class="d-flex align-items-center">
                <img [src]="item.image" class="me-2" style="width: 40px; height: 40px; object-fit: cover;">
                <div>
                  <strong>{{ item.name }}</strong><br>
                  <small class="text-muted">Số lượng: {{ item.quantity }}</small><br>
                  <small class="text-muted">Giá: {{ item.price | currency:'VND' }}</small>
                </div>
              </div>
            </div>
          </li>
          <li *ngIf="cartItems.length === 0">
            <div class="dropdown-item text-muted">
              Giỏ hàng trống
            </div>
          </li>
          <li *ngIf="cartItems.length > 0">
            <hr class="dropdown-divider">
            <a class="dropdown-item text-center" routerLink="/cart">
              Xem tất cả sản phẩm
            </a>
          </li>
        </ul>
      </c-dropdown>
    </c-header-nav>

    <!-- Icon đơn hàng thành công (hiển thị cho ROLE_USER) -->
    <c-header-nav class="d-none d-lg-flex ms-2">
      <c-dropdown alignment="end" variant="nav-item" *ngIf="isLoggedIn && isUserRole">
        <button cButton color="" name="cilCheckCircle" [caret]="false" cDropdownToggle class="py-0 btn-avatar">
          <svg cIcon name="cilCheckCircle" size="lg"></svg>
          <span class="badge bg-success" *ngIf="successfulOrderCount > 0">
            {{ successfulOrderCount }}
          </span>
        </button>
        <ul cDropdownMenu class="dropdown-menu dropdown-menu-end">
          <li *ngFor="let order of successfulOrders">
            <div class="dropdown-item">
              <div class="d-flex align-items-center">
                <div class="me-2">
                  <svg cIcon name="cilCheckCircle" class="text-success"></svg>
                </div>
                <div class="flex-grow-1">
                  <strong>Đơn hàng #{{ order.id }}</strong><br>
                  <small class="text-muted">{{ order.orderDate | date:'dd/MM/yyyy HH:mm' }}</small><br>
                  <small class="text-muted">{{ order.totalAmount | number:'1.0-0' }} VNĐ</small>
                </div>
                <div class="ms-2">
                  <button class="btn btn-sm btn-outline-primary" (click)="viewOrderDetails(order.id!)" *ngIf="order.id">
                    <i class="cil-eye"></i>
                  </button>
                </div>
              </div>
            </div>
          </li>
          <li *ngIf="successfulOrders.length === 0">
            <div class="dropdown-item text-muted">
              Chưa có đơn hàng thành công
            </div>
          </li>
          <li *ngIf="successfulOrders.length > 0">
            <hr class="dropdown-divider">
            <a class="dropdown-item text-center" routerLink="/orders">
              Xem tất cả đơn hàng
            </a>
          </li>
        </ul>
      </c-dropdown>
    </c-header-nav>

    <c-header-nav class="ms-3">
      <ng-container *ngTemplateOutlet="userDropdown"></ng-container>
    </c-header-nav>

  </c-container>
  <c-header-divider></c-header-divider>
  <c-container [fluid]="true">
    <c-breadcrumb-router class="ms-2"></c-breadcrumb-router>
  </c-container>
</ng-container>
<!--</c-header>-->

<ng-template #userDropdown>
  <c-dropdown alignment="end" variant="nav-item">
    <ng-container *ngIf="isAvatar || isAvatarDefault; else loginLink">
      <button cButton color="" [caret]="false" cDropdownToggle class="py-0 btn-avatar">
        <c-avatar *ngIf="isAvatar" cTextColor="primary" shape="rounded-1" size="md" [src]="urlAvatar" status="success">
        </c-avatar>
        <c-avatar *ngIf="isAvatarDefault" cTextColor="primary" shape="rounded-1" size="md"
          src="./assets/img/avatars/default.jpg" status="success">
        </c-avatar>
      </button>
    </ng-container>

    <ng-template #loginLink>
      <a routerLink="/login" cButton color="primary" class="ms-3">Đăng nhập</a>
    </ng-template>

    <ul cDropdownMenu class="pt-0 pr-5 w-auto">
      <li>
        <h6 cDropdownHeader class="bg-light fw-semibold py-2">Tài khoản</h6>
      </li>
      <li>
        <a routerLink="./" cDropdownItem>
          <svg cIcon class="me-2" name="cilBell"></svg>
          Thông báo
          <c-badge class="ms-2 float-end" color="info">
            42
          </c-badge>
        </a>
      </li>
      <li>
        <a routerLink="./" cDropdownItem>
          <svg cIcon class="me-2" name='cilFile'></svg>
          Hướng dẫn sử dụng
        </a>
      </li>
      <li>
        <a cDropdownItem (click)="changePassword()">
          <svg cIcon class="me-2" name='cilReload'></svg>
          Đổi mật khẩu
        </a>
      </li>
      <li>
        <a routerLink="./user/user-info" cDropdownItem>
          <svg cIcon class="me-2" name='cilUser'></svg>
          Tài khoản
        </a>
      </li>
      <li>
        <hr cDropdownDivider />
      </li>
      <li>
        <a (click)="logOut()" cDropdownItem>
          <svg cIcon class="me-2" name="cilLockLocked"></svg>
          Đăng xuất
        </a>
      </li>
      <li></li>
    </ul>
  </c-dropdown>
</ng-template>
